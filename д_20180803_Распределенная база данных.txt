
Задача перенести БП производство из ГБ в ДБ по организации. Обмен из ДБ в ГБ полный. 
		
		
	
Добавить код:
	в модуль объекта обработки "ОбменДаннымиXML" 10002
	
	Если СсылкаНаИсточник <> Неопределено Тогда
				
				//++ Исаков А.В., 15.08.2018 9:48:50. Была ошибка когда источником является ТочкаМаршрутаБизнесПроцесса
				
				Попытка 
					ПродолжитьВыполнение = НЕ СсылкаНаИсточник.Пустая();	
				Исключение 	
					ПродолжитьВыполнение = Истина; //это точка маршрута
				КонецПопытки; 
				
				Если ПродолжитьВыполнение Тогда
					
				//-- Исаков А.В., 15.08.2018 9:49:16. Была ошибка когда источником является ТочкаМаршрутаБизнесПроцесса
	
	
		
		
		
Последовательность действий от (201808):
		
	1. Изменяем состав Плана обмена. ( это нужно для выгрузки только необходимых объектов);
	2. Создаем образ. При создании образа вначале выгружается конфигурация, затем данные. Если во время выгрузки данных появляется ошибка, то данные будут выгруженн частично. 
		Поэтому если вылетает ошибка нужно исправлять ее и начинать с самого начала. 
	3. Отцепляем дочернюю базу от главной. Добавляем в состав плана обмена дополнительные объекты. Подключаем к главной. Делаем CF дочерней и накатываем на Главную (если выполняли пункт 1)
	5. Выгружаем структуру метаданных из главной базы.
	6. На основании структуры метаданных создаем  правила.
	7. Подцепляем правила.
	
Как я обновлял метаданные конфигурации  (201902):
	(т.к. конфигурации исходники я поломал, то по сути делал с начала, за исключений создания правил)
	1.  Обновил свою тестовую конфигурацию из хранилища;
	2.  Скопировал файлы конфигурации в новую папку. Эта база стала "Главная";
	3.  Отключил ее от хранилища;
	4.  Конфигуратор "Главной" - план обмена "CRM_ПоОрганизациям" который я создал давно и судя по всему по аналогии с планом обмена "Полный",
	    указал состав. У меня цель создание образа для тестирования, поэтому указал все кроме бухгалтерского учета и периодических расчетов. После создания образа можно поменять состав, об этом ниже; 
	5.  Захожу в режим 1С:Предприятие в толстом клиенте, захожу в план обмена "По организациям" в 
		нем должно быть два элемента "ГБ - Главная база" и "ДБ - Дочерняя база". У главной базы у картинки должна быть точка,
		Нажимаю на дочернюю и создаю образ;
		У меня во время создания образа несколько раз появлялась ошибка на перенные в коде на которые отсутствовала ссылка, например обращение к общему модулю, который не существует
	6.  Необязательное действие: Захожу в дочернюю, обработкой "УстановкаГлавногоУзлаРИБ" убираю у дочерней главный узел. Затем захожу в конфигуратор изменяю состав плана обмена, если это необходимо,	
		обратно устанавливаю главный узел, и делаю CF, который потом накатываю на Главную базу. Можно не менять состав плана обмена и не откреплять главный узел,
		а сразу сделать CF с дочерней и накатить на главную. В 8.3.12 нужно накатывать с ДБ на ГБ. Но в комментариях на инфостарте читал, что с ГБ на ДБ.
	7.  Для устранения ошибок в дочерней базе требуется каждый раз в ней подключать и отключать главный узел РИБ обработкой.
	8.  Создал с помощью обработки "MD83Exp.epf" файл выгрузки метаданных конфигурации базы "Главная".
	9.  Обновил метаданные конфигурации в КД;
	10. Красным цветом обозначены правила в которых были изменены объекты, с которыми они связаны, желательно пофиксить это;
	11. Выгрузить и загрузить по новой правила в обработку обмена, которая идет в комплексе с конфой: Толстый клиент - Сервис - Распределенная информационная база (РИБ) - Настроить узлы РИБ
	
Исключения из обмена:
	НастройкиОбменаДанными
	ИсторияОбменаДанными
	сфпНастройкиПользователей
	РезультатыОбменаДанными
	CRM_ИнтервалыСотрудниковВременный


	
Ошибки при обмене:
	{Обработка.ОбменДаннымиXML.МодульОбъекта(669)}: Метод объекта не обнаружен (НайтиПоКоду)
	решение: сделал ПИК
	
Вопросы:
	1. Ошибки при закрытии 1С (не сохраняются настроки пользователя)
	2. Ошибка при запуске :
	
						При обновлении информационной базы возникла ошибка:

						{ОбщийМодуль.ОбновлениеИнформационнойБазы.Модуль(105)}: Обновление информационной базы на версию "1.3.78.1" завершилось с ошибками: 
						{ОбщийМодуль.БиблиотекаОбновленияИнформационнойБазы.Модуль(1299)}: Ошибка при получении значения атрибута контекста (ЗадолженностьПоРасчетамЗаНедвижимость)
							СчетОбъект = ПланыСчетов.Налоговый.ЗадолженностьПоРасчетамЗаНедвижимость.ПолучитьОбъект();
						по причине:
						ПланСчетов.Налоговый.ЗадолженностьПоРасчетамЗаНедвижимость. Предопределенный элемент отсутствует в данных
								ВызватьИсключение Сообщение;

						Подробности см. в Журнале регистрации.
	
	3. При указании правил обмена не выполняется синхронизация баз.
	
	
	
РегистрСведений.CRM_ДопСвойстваОтгрузки.Измерение.Отгрузка.Тип
РегистрСведений.CRM_Оповещение.Измерение.Объект.Тип
РегистрСведений.CRM_ТехническоеЗаданиеОтгрузка.Ресурс.Отгрузка.Тип
РегистрСведений.CRM_СостоянияГрузовDPD.Измерение.Отгрузка.Тип
РегистрСведений.CRM_ОтложенныеОповещения.Измерение.Объект.Тип
	
	
Ошибки которые были при обновлении метаданных конфигурации в КД 2.1:
	1.{Обработка.ЗагрузкаСтруктурыМетаданных(491)}: Ошибка при вызове метода контекста (Записать): 
	Ошибка при попытке вставки записи с неуникальным значением ссылки.
	таблица Reference7.
	Объект.Записать();
	по причине:
	Ошибка при попытке вставки записи с неуникальным значением ссылки.
	таблица Reference7.	 
 	Способ обхода:	Заново сформировать файл выгрузки метаданных и выполнить повторную загрузку метаданных.	 
 	Причина возникновения:	Неправильная последовательность действий пользователя.
	
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Задача:
	В базе франча создается документ Счет на оплату покупателю, на основании этого документа создается Счет на оплату поставщику;
	Из базы франчей должны передаваться в нашу базу только документ Счет на оплату покупателю, созданный на основании документ франча "Счет на оплату поставщику";
	Ни счет покупателя, ни счет поставщику созданные в базе франчей в боевой базе опявляться не должны, только счет покупателю, который будет создавать во время 
	обмена на основании данных документ счет поставщику франча;
	В документе покупатель ФРАНЧ, а Продавец МЫ;
	Контрагент - ФРАНЧ, Организация - МЫ;
	
Саша сделала ввод счета поставщику на основании счета покупателю:
	Реквизиты, которые заполняла Саша при создании счета поставщику на основании счета покупателю:
		
		ВалютаДокумента, 
		Организация, 
		СтруктурнаяЕдиница, 
		Склад, 
		КратностьВзаиморасчетов, 
		КурсВзаиморасчетов,
		
		Контрагент
		ДоговорКонтрагента
		Ответственный
		ТЧ:
			Товары
	
&НаСервере
Функция ПолучитьКонтрагентаПоставщика()
	Возврат РегистрыСведений.CRM_Настройки.ПолучитьНастройки().КонтрагентПоставщик;
КонецФункции
	
	
	
	
	
	
	
	